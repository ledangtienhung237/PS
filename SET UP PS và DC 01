Check PS verion:
$PSVersionTable


Script c√†i PowerShell 7.1 (official ‚Äì MSI silent):

$uri = "https://github.com/PowerShell/PowerShell/releases/download/v7.1.5/PowerShell-7.1.5-win-x64.msi"
$msiPath = "$env:TEMP\PowerShell-7.1.5-win-x64.msi"

Invoke-WebRequest -Uri $uri -OutFile $msiPath

Start-Process msiexec.exe -Wait -ArgumentList @(
    "/i `"$msiPath`"",
    "/qn",
    "ADD_EXPLORER_CONTEXT_MENU_OPENPOWERSHELL=1",
    "ADD_FILE_CONTEXT_MENU_RUNPOWERSHELL=1",
    "ENABLE_PSREMOTING=1",
    "REGISTER_MANIFEST=1"
)

X√°c ƒë·ªãnh card m·∫°ng ƒëang ho·∫°t ƒë·ªông kh√¥ng?
$nic = Get-NetAdapter | Where-Object { $_.Status -eq "Up" }


Set DNS ch·ªâ v·ªÅ ch√≠nh Domain Controller v√¨ n·∫øu kh√¥ng s·∫Ω l√¥i
Set-DnsClientServerAddress -InterfaceIndex $nic.InterfaceIndex `
    -ServerAddresses "10.160.17.4"


‚û°Ô∏è Ch·ªâ DC m·ªõi hi·ªÉu c√°c record n√†y

V√¨ sao KH√îNG ƒë∆∞·ª£c d√πng:

Azure DNS (168.63.129.16)

Google DNS

Gateway DNS

üëâ Nh·ªØng DNS n√†y KH√îNG c√≥ SRV records c·ªßa AD

IMPACT n·∫øu kh√¥ng l√†m

L·ªói s·∫Ω KH√îNG xu·∫•t hi·ªán ngay, m√†:

ADFS trust fail

Hybrid Join treo

MFA fail ng·∫´u nhi√™n

Kerberos delay 20‚Äì30s

dsregcmd sai state

‚û°Ô∏è ƒê√¢y l√† lo·∫°i l·ªói r·∫•t t·ªën th·ªùi gian debug


Disable IPv6 tr√™n NIC:

Disable-NetAdapterBinding -Name $nic.Name -ComponentID ms_tcpip6



Flush DNS cache:

ipconfig /flushdns



